<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
		xmlns:xlink="http://www.w3.org/1999/xlink"
		version="1.1"
		baseProfile="basic"
		width="100%" height="100%"
		viewBox="0 0 1000 1000"
		preserveAspectRatio="xMidYMid meet"
		clip-path="url(#clip-all)"
		id="display"
		>
	<title>#F00 Baron</title>
	<defs>
		<style type="text/css">
			<![CDATA[
				#background path {
					stroke: #000;
					stroke-width: 5;
					stroke-linecap: round;
					stroke-linejoin: miter;
				}
				#mountains path {
					fill: url(#pattern-mountain);
				}
				#hills path {
					fill: url(#pattern-hill);
				}
				#ground {
					fill: url(#pattern-ground);
					stroke: #000;
					stroke-width: 5;
				}
				
				.player1 {
					color: #f00;
				}
				.player2 {
					color: #00f;
				}
			]]>
		</style>
	</defs>
	
	<script type="text/ecmascript" xlink:href="lib/jquery-1.7.1.js"></script>
	<script type="text/ecmascript" xlink:href="lib/jquery.svg.js"></script>
	<script type="text/ecmascript" xlink:href="lib/jquery.svgdom.js"></script>
	<script type="text/ecmascript" xlink:href="game.js"></script>
	<script type="text/ecmascript">
		//<![CDATA[
		
		// Randomise cloud positions
		jQuery(document).on('beginEvent repeatEvent', '.cloud', function(event) {
			var cloud = jQuery(this);
			var shape = cloud.find('use');
			// Pick a new y-value (between 200 and 600) for the next pass
			var new_y = 200 + (Math.random() * 400);
			cloud.attr('y', Math.floor(new_y));
			// Pick a new duration (10-60s)
			var new_dur = 10 + (Math.random() * 50);
			cloud.find('animate').attr('dur', Math.floor(new_dur));
		});
		
		// window..load because document..ready doesn't work for SVG
		jQuery(window).load(function() {
			// Init game
			var game = new f00baron.Game();
			game.add_player({
				 element: jQuery('#player1')
				,controls: {
					// Player 1 - WSAD
					 87: 'engineOn'
					,83: 'engineOff'
					,65: 'rotateACW'
					,68: 'rotateCW'
				}
			});
			
			// Start main loop
			game.start();
		});
		//]]>
	</script>
	
	<defs>
		<clipPath id="clip-all">
			<rect x="0" y="0" width="100%" height="100%" />
		</clipPath>
	</defs>
	
	<g id="background">
		<defs>
			<linearGradient id="pattern-sky"
					x1="0" y1="0"
					x2="0" y2="100%"
					>
				<stop offset="0" stop-color="#04f" />
				<stop offset="1" stop-color="#8cf" />
			</linearGradient>
			<linearGradient id="pattern-mountain"
					x1="0" y1="0"
					x2="0" y2="100%"
					>
				<stop offset="0" stop-color="#fff" />
				<stop offset="0.1" stop-color="#fff" />
				<stop offset="0.3" stop-color="#888" />
				<stop offset="1" stop-color="#444" />
			</linearGradient>
			<linearGradient id="pattern-hill"
					x1="0" y1="0"
					x2="0" y2="100%"
					>
				<stop offset="0" stop-color="#4c4" />
				<stop offset="1" stop-color="#080" />
			</linearGradient>
			<linearGradient id="pattern-ground"
					x1="0" y1="0"
					x2="0" y2="100%"
					>
				<stop offset="0" stop-color="#840" />
				<stop offset="1" stop-color="#420" />
			</linearGradient>
		</defs>
		
		<rect id="sky"
				x="0" y="0"
				width="100%" height="100%"
				fill="url(#pattern-sky)"
				/>
		
		<g id="help" style="
				font-family: sans;
				font-size: 40;
				">
			<text x="50" y="100"
					stroke="#000" stroke-width="2"
					fill="#f00"
					font-size="100" font-weight="bold"
					>#F00 Baron</text>
			<animate attributeType="css" attributeName="fill-opacity"
					from="1" to="0"
					begin="2s" dur="3s"
					fill="freeze"
					/>
			<animate attributeType="css" attributeName="stroke-opacity"
					from="1" to="0"
					begin="3s" dur="2.5s"
					fill="freeze"
					/>
		</g>
		
		<g id="mountains">
			<path d="M -300,950 l 350,-250 L 400,950" />
			<path d="M 200,950 l 300,-200 l 20,-30 l 50,-10 L 800,950" />
			<path d="M 500,950 l 200,-250 l 100,-60 l 50,20 l 100,10 L 1100,950" />
			<path d="M -150,950 l 350,-350 l 70,70 l 40,-20 l 80,100 L 550,950" />
		</g>
		<g id="hills">
			<path d="M 400,950 q 300,-200 600,0" />
			<path d="M 100,950 q 200,-300 400,0" />
			<path d="M -100,950 q 200,-200 400,0" />
			<path d="M 550,950 q 100,-100 200,0" />
			<path d="M 800,950 q 200,-200 400,0" />
		</g>
	</g>
	
	<g id="planes">
		<svg id="player1"
				x="50" y="935"
				overflow="visible">
			<g class="scaler" transform="scale(1.5)">
				<use xlink:href="planes.svg#plane-1"
						class="plane player1 rotator"
						transform="rotate(-10)"
						/>
			</g>
		</svg>
	</g>
	
	<g id="foreground">
		<g id="clouds">
			<svg class="cloud" overflow="visible" y="200">
				<use xlink:href="clouds.svg#cloud-2" />
				<animate id="c1a1"
						attributeType="XML" attributeName="x"
						from="1200" to="-200"
						begin="0s;c1a1.end"
						dur="30s" fill="freeze"
						/>
			</svg>
			<svg class="cloud" overflow="visible" y="600">
				<use xlink:href="clouds.svg#cloud-2" />
				<animate id="c2a1"
						attributeType="XML" attributeName="x"
						from="-200" to="1200"
						begin="0s;c2a1.end"
						dur="25s" fill="freeze"
						/>
			</svg>
			<svg class="cloud" overflow="visible" y="400">
				<use xlink:href="clouds.svg#cloud-2" />
				<animate id="c3a1"
						attributeType="XML" attributeName="x"
						from="1200" to="-200"
						begin="0s;c3a1.end"
						dur="20s" fill="freeze"
						/>
			</svg>
		</g>
		
		<rect id="ground"
				x="0" y="950"
				width="100%" height="50"
				/>
	</g>
</svg>
